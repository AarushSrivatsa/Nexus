/* ═══════════════════════════════════════════════════════════
   NEXUS — Production CSS
   ═══════════════════════════════════════════════════════════ */

/* ── RESET ───────────────────────────────────────────────── */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}

/* ── TOKENS ──────────────────────────────────────────────── */
:root{
  --bg:#05080d;
  --s1:#080e16;
  --s2:#0c1520;
  --s3:#111e2e;
  --b1:#162030;
  --b2:#1e2e42;
  --t1:#eef4ff;
  --t2:#7a9bbf;
  --t3:#3a5470;
  --a:#00e5ff;
  --a2:#0066ff;
  --ag:linear-gradient(135deg,#00e5ff,#0066ff);
  --adim:rgba(0,229,255,.07);
  --aglow:rgba(0,229,255,.15);
  --ab:rgba(0,229,255,.17);
  --abhi:rgba(0,229,255,.35);
  --abnew:rgba(0,229,255,.16);
  --abbg:rgba(0,229,255,.11);
  --abact:rgba(0,229,255,.12);
  --danger:#ff3d6b;
  --db:rgba(255,61,107,.18);
  --dbhi:rgba(255,61,107,.35);
  --dbg:rgba(255,61,107,.06);
  --dglow:rgba(255,61,107,.08);
  --ease:cubic-bezier(.16,1,.3,1);
  --ease2:cubic-bezier(.4,0,.2,1);
  --sb:272px;
  --topbar:52px;
  /* safe areas */
  --sat:env(safe-area-inset-top,0px);
  --sab:env(safe-area-inset-bottom,0px);
  --sal:env(safe-area-inset-left,0px);
  --sar:env(safe-area-inset-right,0px);
}

/* ── BASE ────────────────────────────────────────────────── */
html{
  height:100%;
  -webkit-text-size-adjust:100%;
  text-size-adjust:100%;
  overflow:hidden;
}

body{
  font-family:'DM Sans',sans-serif;
  background:var(--bg);
  color:var(--t1);
  display:flex;
  overflow:hidden;
  font-size:14px;
  height:100dvh;
  width:100dvw;
  position:fixed; /* kills iOS bounce */
  top:0;left:0;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* ambient bg */
body::before{
  content:'';position:fixed;
  top:-300px;right:-300px;
  width:700px;height:700px;
  background:radial-gradient(circle,rgba(0,229,255,.04) 0%,transparent 65%);
  pointer-events:none;z-index:0;
}

/* scrollbars — desktop only */
@media(hover:hover){
  ::-webkit-scrollbar{width:3px;height:3px;}
  ::-webkit-scrollbar-track{background:transparent;}
  ::-webkit-scrollbar-thumb{background:var(--b2);border-radius:3px;}
}

/* focus ring */
:focus-visible{outline:2px solid var(--a);outline-offset:3px;}
button:focus:not(:focus-visible){outline:none;}

/* ═══════════════════════════════════════════════════════════
   AUTH
   ═══════════════════════════════════════════════════════════ */
#auth-overlay{
  position:fixed;inset:0;
  background:var(--bg);
  display:flex;
  align-items:flex-start;
  justify-content:center;
  z-index:200;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  overscroll-behavior:contain;
  transition:opacity .4s var(--ease),visibility .4s;
  padding:max(44px,calc(var(--sat) + 24px)) 0 max(44px,calc(var(--sab) + 24px));
}
#auth-overlay.hidden{opacity:0;visibility:hidden;pointer-events:none;}

.auth-wrap{width:100%;max-width:400px;padding:0 28px;margin:auto;}

.auth-logo{display:flex;align-items:center;gap:12px;margin-bottom:36px;}
.auth-logo-mark{
  width:44px;height:44px;border-radius:13px;background:var(--ag);
  display:flex;align-items:center;justify-content:center;flex-shrink:0;
  box-shadow:0 0 32px rgba(0,229,255,.22),0 0 0 1px rgba(0,229,255,.14);
}
.auth-logo-name{
  font-family:'Space Grotesk',sans-serif;font-size:18px;font-weight:700;
  letter-spacing:.18em;display:block;
  background:var(--ag);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.auth-byline{font-size:10px;color:var(--t3);font-family:'Space Grotesk',sans-serif;font-weight:500;letter-spacing:.04em;margin-top:2px;}
.auth-byline-link,.sb-byline-link{color:var(--t3);text-decoration:none;transition:color .2s;}
.auth-byline-link:hover,.sb-byline-link:hover{color:var(--a);}

.auth-h{font-family:'Space Grotesk',sans-serif;font-size:24px;font-weight:600;letter-spacing:-.02em;margin-bottom:6px;line-height:1.2;}
.auth-sub{font-size:13px;color:var(--t3);margin-bottom:28px;line-height:1.6;}

/* tab switcher */
.seg{display:flex;background:var(--s1);border:1px solid var(--b1);border-radius:13px;padding:4px;margin-bottom:22px;gap:3px;}
.seg-btn{
  flex:1;padding:9px 6px;border:none;background:none;border-radius:9px;
  font-family:'Space Grotesk',sans-serif;font-size:12px;font-weight:600;
  color:var(--t3);cursor:pointer;transition:all .2s var(--ease2);letter-spacing:.04em;
  min-height:38px;-webkit-tap-highlight-color:transparent;
}
.seg-btn.on{background:var(--s3);color:var(--t1);box-shadow:0 1px 8px rgba(0,0,0,.3);}

/* form fields */
.fg{margin-bottom:14px;}
.fg label{
  display:block;font-family:'Space Grotesk',sans-serif;
  font-size:10px;font-weight:700;letter-spacing:.1em;text-transform:uppercase;
  color:var(--t3);margin-bottom:7px;
}
.fg input{
  width:100%;padding:13px 16px;
  background:var(--s1);border:1px solid var(--b1);border-radius:12px;
  font-family:'DM Sans',sans-serif;font-size:16px;color:var(--t1);
  outline:none;transition:border-color .2s,box-shadow .2s;
  -webkit-appearance:none;appearance:none;
}
.fg input:focus{border-color:var(--abhi);box-shadow:0 0 0 3px var(--adim);}
.fg input::placeholder{color:var(--t3);}

/* password toggle */
.pw-wrap{position:relative;}
.pw-wrap input{padding-right:48px;}
.pw-eye{
  position:absolute;right:12px;top:50%;transform:translateY(-50%);
  background:none;border:none;cursor:pointer;color:var(--t3);
  display:flex;align-items:center;justify-content:center;
  transition:color .2s;padding:7px;z-index:2;
  -webkit-tap-highlight-color:transparent;
}
.pw-eye:hover{color:var(--t2);}

/* OTP */
.otp-row{display:flex;gap:8px;}
.otp-row input{flex:1;text-align:center;font-family:'JetBrains Mono',monospace;font-size:20px;letter-spacing:.15em;}
.otp-resend{
  padding:12px 14px;background:var(--s2);border:1px solid var(--b1);border-radius:12px;
  font-family:'Space Grotesk',sans-serif;font-size:11px;font-weight:700;
  color:var(--t2);cursor:pointer;white-space:nowrap;transition:all .2s;flex-shrink:0;
  -webkit-tap-highlight-color:transparent;
}
.otp-resend:hover:not(:disabled){border-color:var(--b2);color:var(--t1);}
.otp-resend:disabled{opacity:.35;cursor:not-allowed;}

/* primary button */
.btn-main{
  width:100%;padding:14px;margin-top:8px;background:var(--ag);border:none;border-radius:12px;
  font-family:'Space Grotesk',sans-serif;font-size:13px;font-weight:700;
  color:#000;cursor:pointer;letter-spacing:.04em;
  transition:opacity .2s,transform .15s var(--ease),box-shadow .2s;
  box-shadow:0 4px 24px rgba(0,229,255,.13);min-height:48px;
  -webkit-tap-highlight-color:transparent;
}
.btn-main:hover{opacity:.87;box-shadow:0 6px 32px rgba(0,229,255,.23);}
.btn-main:active{transform:scale(.97);}
.btn-main:disabled{opacity:.4;cursor:not-allowed;transform:none;}

.auth-err{font-size:12px;color:var(--danger);margin-top:10px;min-height:18px;font-weight:500;line-height:1.5;}

.email-pill{
  margin-bottom:16px;padding:11px 16px;
  background:var(--s2);border:1px solid var(--b1);border-radius:12px;
  display:flex;align-items:center;justify-content:space-between;gap:8px;
}
.email-pill span{font-size:12px;color:var(--t2);font-weight:500;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.email-pill button{font-family:'Space Grotesk',sans-serif;font-size:11px;font-weight:700;color:var(--a);background:none;border:none;cursor:pointer;flex-shrink:0;padding:4px 0;}

/* ═══════════════════════════════════════════════════════════
   SIDEBAR OVERLAY
   ═══════════════════════════════════════════════════════════ */
#sb-overlay{
  display:none;
  position:fixed;inset:0;
  background:rgba(0,0,0,.65);
  z-index:49;
  opacity:0;pointer-events:none;
  transition:opacity .28s var(--ease2);
  backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);
  touch-action:none;
}
#sb-overlay.open{opacity:1;pointer-events:all;}

/* ═══════════════════════════════════════════════════════════
   SIDEBAR
   ═══════════════════════════════════════════════════════════ */
#sidebar{
  width:var(--sb);
  background:var(--s1);
  border-right:1px solid var(--b1);
  display:flex;flex-direction:column;
  flex-shrink:0;
  position:relative;z-index:1;
  transition:transform .3s var(--ease);
  padding-left:var(--sal);
}

.sb-top{
  padding:16px 16px 14px;
  padding-top:max(16px,calc(var(--sat) + 10px));
  border-bottom:1px solid var(--b1);
  display:flex;align-items:center;flex-shrink:0;
}
.sb-brand{display:flex;align-items:center;gap:10px;}
.sb-mark{
  width:28px;height:28px;border-radius:8px;background:var(--ag);
  display:flex;align-items:center;justify-content:center;flex-shrink:0;
  box-shadow:0 0 14px rgba(0,229,255,.16),0 0 0 1px rgba(0,229,255,.1);
}
.sb-name{
  font-family:'Space Grotesk',sans-serif;font-size:13px;font-weight:700;letter-spacing:.12em;
  background:var(--ag);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.sb-brand-text{display:flex;flex-direction:column;gap:1px;}
.sb-byline{font-size:9px;color:var(--t3);font-family:'Space Grotesk',sans-serif;font-weight:500;letter-spacing:.04em;}

.sb-new-wrap{padding:10px 10px 4px;flex-shrink:0;}
.sb-new-btn{
  width:100%;padding:10px 14px;
  background:var(--adim);border:1px solid var(--abnew);border-radius:11px;
  cursor:pointer;font-family:'Space Grotesk',sans-serif;font-size:12px;font-weight:700;
  color:var(--a);letter-spacing:.04em;
  transition:all .2s var(--ease2);
  display:flex;align-items:center;justify-content:center;gap:7px;
  min-height:42px;-webkit-tap-highlight-color:transparent;
}
.sb-new-btn:hover{background:var(--abbg);border-color:var(--abhi);box-shadow:0 0 18px var(--aglow);}
.sb-new-btn:active{transform:scale(.98);}

.sb-list{
  flex:1;overflow-y:auto;padding:4px 8px;
  -webkit-overflow-scrolling:touch;overscroll-behavior:contain;
}
.sb-section{
  font-family:'Space Grotesk',sans-serif;font-size:9px;font-weight:700;
  letter-spacing:.14em;text-transform:uppercase;color:var(--t3);
  padding:12px 8px 5px;
}
.sb-item{
  padding:10px;border-radius:10px;cursor:pointer;
  display:flex;align-items:center;justify-content:space-between;
  transition:background .15s var(--ease2),border-color .15s;
  gap:8px;border:1px solid transparent;margin-bottom:1px;min-height:40px;
  -webkit-tap-highlight-color:transparent;
}
.sb-item:hover{background:var(--s2);}
.sb-item.active{background:var(--adim);border-color:var(--abact);}
.sb-item-title{font-size:12px;color:var(--t2);font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1;transition:color .15s;}
.sb-item.active .sb-item-title{color:var(--a);}
.sb-item:hover .sb-item-title{color:var(--t1);}

.sb-del{
  width:24px;height:24px;border:none;background:none;border-radius:5px;
  cursor:pointer;color:var(--t3);display:none;align-items:center;justify-content:center;
  flex-shrink:0;transition:color .15s;-webkit-tap-highlight-color:transparent;
}
.sb-item:hover .sb-del{display:flex;}
.sb-del:hover{color:var(--danger);}

.sb-foot{
  padding:10px;border-top:1px solid var(--b1);
  display:flex;flex-direction:column;gap:6px;flex-shrink:0;
  padding-bottom:max(10px,calc(var(--sab) + 8px));
}
.sb-logout{
  width:100%;padding:11px;background:transparent;
  border:1px solid var(--db);border-radius:11px;cursor:pointer;
  font-family:'Space Grotesk',sans-serif;font-size:12px;font-weight:700;
  color:var(--danger);letter-spacing:.04em;
  transition:all .2s var(--ease2);
  display:flex;align-items:center;justify-content:center;gap:7px;
  min-height:44px;-webkit-tap-highlight-color:transparent;
}
.sb-logout:hover{background:var(--dbg);border-color:var(--dbhi);box-shadow:0 0 14px var(--dglow);}
.sb-logout:active{transform:scale(.98);}

/* ═══════════════════════════════════════════════════════════
   MAIN CONTENT
   ═══════════════════════════════════════════════════════════ */
#main{flex:1;display:flex;flex-direction:column;overflow:hidden;position:relative;z-index:1;min-width:0;}

.topbar{
  height:var(--topbar);
  border-bottom:1px solid var(--b1);
  background:var(--s1);
  display:flex;align-items:center;justify-content:space-between;
  flex-shrink:0;gap:10px;
  padding:0 max(20px,var(--sar)) 0 max(20px,var(--sal));
}
.topbar-title{
  font-family:'Space Grotesk',sans-serif;font-size:13px;font-weight:600;
  color:var(--t2);letter-spacing:.02em;
  flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;
}
.tb-btn{
  width:36px;height:36px;border:1px solid var(--b1);border-radius:9px;
  background:none;cursor:pointer;color:var(--t3);
  display:flex;align-items:center;justify-content:center;
  transition:all .2s var(--ease2);flex-shrink:0;
  -webkit-tap-highlight-color:transparent;
}
.tb-btn:hover{border-color:var(--b2);color:var(--t2);background:var(--s2);}
.tb-btn:active{transform:scale(.9);}
/* hidden on desktop, shown on mobile via media query */
.tb-btn.desktop-hide{display:none;}

/* ═══════════════════════════════════════════════════════════
   MESSAGES
   ═══════════════════════════════════════════════════════════ */
#messages{
  flex:1;overflow-y:auto;
  padding:32px 11% 24px;
  display:flex;flex-direction:column;gap:10px;
  scroll-behavior:smooth;
  -webkit-overflow-scrolling:touch;
  overscroll-behavior:contain;
}

/* empty states */
.empty,.no-conv{
  flex:1;display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  gap:14px;padding-bottom:60px;pointer-events:none;
  animation:rise .4s var(--ease);
}
.empty-glyph,.no-conv-glyph{
  width:52px;height:52px;border-radius:16px;
  background:linear-gradient(135deg,rgba(0,229,255,.09),rgba(0,102,255,.04));
  border:1px solid rgba(0,229,255,.12);
  display:flex;align-items:center;justify-content:center;font-size:22px;
}
.empty-title,.no-conv-text{font-family:'Space Grotesk',sans-serif;font-size:15px;font-weight:600;color:var(--t2);}
.empty-hint{font-size:12px;color:var(--t3);text-align:center;max-width:260px;line-height:1.7;}

/* message rows */
.msg-row{display:flex;animation:rise .22s var(--ease);}
.msg-row.user{justify-content:flex-end;}
.msg-row.assistant{justify-content:flex-start;}
@keyframes rise{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}

/* bubbles */
.msg-bubble{
  max-width:72%;padding:12px 18px;
  font-size:13.5px;line-height:1.75;
  word-break:break-word;overflow-wrap:break-word;
}
.msg-row.user .msg-bubble{
  background:var(--ag);color:#000;font-weight:500;
  border-radius:20px 20px 5px 20px;
  box-shadow:0 4px 20px rgba(0,229,255,.1);
}
.msg-row.assistant .msg-bubble{
  background:var(--s2);color:var(--t1);
  border-radius:20px 20px 20px 5px;border:1px solid var(--b1);
}

/* ── LINKS — CRITICAL: clickable, open new tab ─────────── */
.msg-bubble a{
  color:var(--a);
  text-decoration:underline;
  text-underline-offset:3px;
  text-decoration-color:rgba(0,229,255,.35);
  transition:color .15s,text-decoration-color .15s;
  word-break:break-all;
  cursor:pointer;
}
.msg-bubble a:hover{
  color:#fff;
  text-decoration-color:var(--a);
}
.msg-row.user .msg-bubble a{
  color:rgba(0,0,0,.75);
  text-decoration-color:rgba(0,0,0,.25);
}
.msg-row.user .msg-bubble a:hover{color:#000;text-decoration-color:rgba(0,0,0,.6);}

/* ── CODE ────────────────────────────────────────────────── */
.msg-bubble pre{
  font-family:'JetBrains Mono',monospace;font-size:12px;
  background:rgba(0,0,0,.4);border:1px solid var(--b2);
  padding:14px 16px;border-radius:12px;overflow-x:auto;
  margin:10px 0 4px;line-height:1.65;color:var(--a);
  -webkit-overflow-scrolling:touch;
  position:relative;
}
.msg-bubble pre code{background:none;padding:0;border:none;border-radius:0;font-size:inherit;color:inherit;}
.msg-row.user .msg-bubble pre{background:rgba(0,0,0,.2);border-color:rgba(0,0,0,.15);color:#000;}

.msg-bubble code{
  font-family:'JetBrains Mono',monospace;font-size:11.5px;
  background:var(--s3);padding:2px 6px;border-radius:5px;
  color:var(--a);border:1px solid var(--b2);word-break:break-word;
}
.msg-row.user .msg-bubble code{background:rgba(0,0,0,.15);color:#000;border-color:rgba(0,0,0,.1);}

/* ── HEADINGS ────────────────────────────────────────────── */
.msg-bubble .mh1{font-family:'Space Grotesk',sans-serif;font-size:15px;font-weight:700;margin:18px 0 6px;color:var(--t1);line-height:1.3;}
.msg-bubble .mh2{font-family:'Space Grotesk',sans-serif;font-size:14px;font-weight:700;margin:14px 0 5px;color:var(--t1);line-height:1.3;}
.msg-bubble .mh3{font-family:'Space Grotesk',sans-serif;font-size:13px;font-weight:700;margin:12px 0 4px;color:var(--t1);line-height:1.3;}
.msg-bubble .mh1:first-child,.msg-bubble .mh2:first-child,.msg-bubble .mh3:first-child{margin-top:2px;}
.msg-row.user .msg-bubble .mh1,.msg-row.user .msg-bubble .mh2,.msg-row.user .msg-bubble .mh3{color:#000;}

/* ── PARAGRAPHS ──────────────────────────────────────────── */
.msg-bubble p{margin:0 0 10px;line-height:1.75;}
.msg-bubble p:last-child{margin-bottom:0;}

/* ── LISTS ───────────────────────────────────────────────── */
.msg-bubble ul,.msg-bubble ol{margin:6px 0 10px;padding-left:0;list-style:none;}
.msg-bubble ul:last-child,.msg-bubble ol:last-child{margin-bottom:0;}
.msg-bubble li{padding:3px 0 3px 22px;position:relative;line-height:1.7;}
.msg-bubble ul li::before{content:'•';position:absolute;left:7px;color:var(--a);font-size:15px;line-height:1.7;}
.msg-bubble ol{counter-reset:ol-c;}
.msg-bubble ol li{counter-increment:ol-c;}
.msg-bubble ol li::before{content:counter(ol-c)'.';position:absolute;left:0;color:var(--a);font-size:11px;font-family:'JetBrains Mono',monospace;font-weight:600;line-height:2;}
.msg-row.user .msg-bubble ul li::before,.msg-row.user .msg-bubble ol li::before{color:rgba(0,0,0,.5);}

/* ── OTHER ELEMENTS ──────────────────────────────────────── */
.msg-bubble hr{border:none;border-top:1px solid var(--b2);margin:14px 0;}
.msg-bubble blockquote{border-left:3px solid var(--abhi);padding-left:14px;margin:8px 0;color:var(--t2);font-style:italic;line-height:1.7;}
.msg-row.user .msg-bubble blockquote{border-left-color:rgba(0,0,0,.2);color:rgba(0,0,0,.7);}
.msg-row.user .msg-bubble hr{border-top-color:rgba(0,0,0,.15);}
.msg-row.user .msg-bubble strong{color:#000;}

/* ── TYPING INDICATOR ────────────────────────────────────── */
.typing{display:flex;gap:5px;align-items:center;padding:4px 2px;}
.tdot{width:5px;height:5px;border-radius:50%;background:var(--t3);animation:tdot 1.4s infinite;}
.tdot:nth-child(2){animation-delay:.18s;}
.tdot:nth-child(3){animation-delay:.36s;}
@keyframes tdot{0%,60%,100%{transform:translateY(0);opacity:.3;}30%{transform:translateY(-6px);opacity:1;}}

/* ═══════════════════════════════════════════════════════════
   INPUT AREA
   ═══════════════════════════════════════════════════════════ */
.input-area{
  padding:6px 11% 14px;flex-shrink:0;
  padding-bottom:max(14px,calc(var(--sab) + 8px));
}
.input-wrap{
  display:flex;flex-direction:column;
  background:var(--s1);border:1px solid var(--b2);border-radius:16px;
  padding:8px 8px 6px 16px;
  transition:border-color .25s,box-shadow .25s;
}
.input-wrap:focus-within{border-color:var(--ab);box-shadow:0 0 0 3px var(--adim);}
.input-row{display:flex;align-items:flex-end;gap:8px;}

#msg-input{
  flex:1;border:none;background:none;
  font-family:'DM Sans',sans-serif;
  font-size:16px; /* MUST be 16px+ to prevent iOS auto-zoom */
  color:var(--t1);outline:none;resize:none;
  max-height:160px;line-height:1.6;padding:3px 0;
  -webkit-appearance:none;
}
#msg-input::placeholder{color:var(--t3);}

.input-btns{display:flex;gap:4px;align-items:center;flex-shrink:0;padding-bottom:2px;}

.ib{
  width:34px;height:34px;border:1px solid var(--b2);border-radius:9px;
  background:none;cursor:pointer;color:var(--t3);
  display:flex;align-items:center;justify-content:center;
  transition:all .2s var(--ease2);flex-shrink:0;
  -webkit-tap-highlight-color:transparent;
}
.ib:hover{border-color:var(--abhi);color:var(--a);background:var(--adim);}
.ib:active{transform:scale(.9);}

.send-ib{
  width:34px;height:34px;background:var(--ag);border:none;border-radius:9px;
  cursor:pointer;color:#000;
  display:flex;align-items:center;justify-content:center;
  transition:opacity .2s,transform .15s var(--ease),box-shadow .2s;
  box-shadow:0 2px 14px rgba(0,229,255,.17);flex-shrink:0;
  -webkit-tap-highlight-color:transparent;
}
.send-ib:hover{opacity:.87;box-shadow:0 4px 22px rgba(0,229,255,.27);}
.send-ib:active{transform:scale(.88);}
.send-ib:disabled{opacity:.2;cursor:not-allowed;box-shadow:none;transform:none;}

/* ═══════════════════════════════════════════════════════════
   MODEL BAR
   ═══════════════════════════════════════════════════════════ */
.model-bar{
  display:flex;align-items:center;gap:5px;
  padding:7px 0 3px;
  border-top:1px solid var(--b1);margin-top:5px;
  overflow-x:auto;scrollbar-width:none;-webkit-overflow-scrolling:touch;
}
.model-bar::-webkit-scrollbar{display:none;}
.model-bar-label{
  font-family:'Space Grotesk',sans-serif;font-size:9px;font-weight:700;
  letter-spacing:.12em;text-transform:uppercase;color:var(--t3);
  flex-shrink:0;margin-right:2px;
}
.model-chip{
  display:inline-flex;align-items:center;gap:5px;
  padding:5px 12px;border-radius:100px;
  border:1px solid var(--b1);background:none;
  font-family:'Space Grotesk',sans-serif;font-size:10px;font-weight:700;
  color:var(--t3);cursor:pointer;white-space:nowrap;letter-spacing:.04em;
  transition:all .18s var(--ease2);flex-shrink:0;min-height:28px;
  -webkit-tap-highlight-color:transparent;
}
.model-chip:hover{border-color:var(--b2);color:var(--t2);background:var(--s2);}
.model-chip.active{border-color:var(--abhi);color:var(--a);background:var(--adim);}
.model-chip-dot{width:5px;height:5px;border-radius:50%;background:var(--t3);transition:background .18s;flex-shrink:0;}
.model-chip.active .model-chip-dot{background:var(--a);}

/* ═══════════════════════════════════════════════════════════
   MODALS
   ═══════════════════════════════════════════════════════════ */
.modal-bg{
  position:fixed;inset:0;background:rgba(0,0,0,.78);
  display:flex;align-items:center;justify-content:center;
  z-index:100;opacity:0;pointer-events:none;
  transition:opacity .22s var(--ease2);
  backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);
  padding:20px;
}
.modal-bg.open{opacity:1;pointer-events:all;}

.modal-box{
  background:var(--s1);border:1px solid var(--b2);border-radius:22px;
  padding:28px;width:100%;max-width:420px;
  transform:translateY(18px) scale(.95);
  transition:transform .3s var(--ease);
  box-shadow:0 32px 80px rgba(0,0,0,.7);
  max-height:calc(100dvh - 48px);
  overflow-y:auto;-webkit-overflow-scrolling:touch;
}
.modal-bg.open .modal-box{transform:translateY(0) scale(1);}
.modal-title{font-family:'Space Grotesk',sans-serif;font-size:16px;font-weight:700;margin-bottom:4px;}
.modal-sub{font-size:12px;color:var(--t3);margin-bottom:22px;line-height:1.6;}

.up-tabs{display:flex;gap:3px;background:var(--s2);border:1px solid var(--b1);border-radius:12px;padding:3px;margin-bottom:16px;}
.up-tab{
  flex:1;padding:9px;border:none;background:none;border-radius:9px;
  font-family:'Space Grotesk',sans-serif;font-size:12px;font-weight:700;
  color:var(--t3);cursor:pointer;transition:all .2s var(--ease2);
  min-height:38px;-webkit-tap-highlight-color:transparent;
}
.up-tab.on{background:var(--s3);color:var(--t1);}

.dropzone{
  border:1px dashed var(--b2);border-radius:14px;
  padding:32px 20px;text-align:center;cursor:pointer;
  transition:all .2s var(--ease2);margin-bottom:12px;
  -webkit-tap-highlight-color:transparent;
}
.dropzone:hover,.dropzone.drag{border-color:var(--abhi);background:var(--adim);}
.dropzone-icon{font-size:28px;margin-bottom:10px;}
.dropzone-text{font-size:12px;color:var(--t3);line-height:1.7;}
.dropzone-text strong{color:var(--t2);}
#file-input{display:none;}
#file-name{font-size:12px;color:var(--a);min-height:18px;font-weight:600;padding-top:2px;line-height:1.5;}

.modal-foot{display:flex;gap:8px;justify-content:flex-end;margin-top:20px;}
.btn-ghost{
  padding:11px 18px;background:none;border:1px solid var(--b2);border-radius:10px;
  font-family:'Space Grotesk',sans-serif;font-size:12px;font-weight:700;
  color:var(--t2);cursor:pointer;transition:all .2s;min-height:42px;
  -webkit-tap-highlight-color:transparent;
}
.btn-ghost:hover{color:var(--t1);}
.btn-act{
  padding:11px 20px;background:var(--ag);border:none;border-radius:10px;
  font-family:'Space Grotesk',sans-serif;font-size:12px;font-weight:700;
  color:#000;cursor:pointer;min-height:42px;
  transition:opacity .2s,transform .15s var(--ease);
  box-shadow:0 2px 12px rgba(0,229,255,.13);
  -webkit-tap-highlight-color:transparent;
}
.btn-act:hover{opacity:.87;}
.btn-act:active{transform:scale(.97);}

/* ═══════════════════════════════════════════════════════════
   TOAST
   ═══════════════════════════════════════════════════════════ */
#toast{
  position:fixed;
  bottom:max(28px,calc(var(--sab) + 14px));
  left:50%;
  transform:translateX(-50%) translateY(16px);
  background:var(--s3);border:1px solid var(--b2);
  color:var(--t1);padding:10px 22px;border-radius:100px;
  font-size:12px;font-weight:600;
  opacity:0;pointer-events:none;
  transition:all .3s var(--ease);z-index:400;
  white-space:nowrap;
  box-shadow:0 10px 40px rgba(0,0,0,.6);
  max-width:calc(100dvw - 48px);
}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0);}

/* file pill */
.file-pill{display:flex;justify-content:center;margin:8px 0;}
.file-pill-inner{
  background:var(--s2);border:1px solid var(--b1);border-radius:100px;
  padding:6px 16px;font-size:11px;color:var(--t3);
  display:flex;align-items:center;gap:7px;font-weight:600;max-width:90%;
}
.file-pill-inner span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}

/* ═══════════════════════════════════════════════════════════
   MOBILE  ≤ 680px
   ═══════════════════════════════════════════════════════════ */
@media(max-width:680px){
  :root{--sb:82vw;}

  /* show mobile topbar buttons */
  .tb-btn.desktop-hide{display:flex;}

  /* sidebar → off-canvas fixed drawer */
  #sidebar{
    position:fixed;top:0;left:0;
    height:100dvh;z-index:50;
    transform:translateX(-100%);
    border-right:none;box-shadow:none;
  }
  #sidebar.open{
    transform:translateX(0);
    border-right:1px solid var(--b1);
    box-shadow:12px 0 60px rgba(0,0,0,.8);
  }
  #sb-overlay{display:block;}

  /* always show delete button (no hover on touch) */
  .sb-del{display:flex !important;}

  /* messages */
  #messages{padding:16px 4% 12px;gap:6px;}
  .msg-bubble{max-width:90%;font-size:13px;padding:10px 14px;}
  .msg-bubble pre{font-size:11px;padding:10px 12px;}
  .msg-bubble code{font-size:11px;}

  /* input */
  .input-area{
    padding:4px 10px;
    padding-bottom:max(10px,calc(var(--sab) + 6px));
  }
  .input-wrap{padding:6px 6px 5px 14px;}

  /* modals → slide up from bottom sheet */
  .modal-bg{align-items:flex-end;padding:0;}
  .modal-box{
    max-width:100% !important;
    border-radius:24px 24px 0 0;
    border-bottom:none;
    padding:20px 20px;
    padding-bottom:max(22px,calc(var(--sab) + 16px));
    transform:translateY(100%);
    max-height:92dvh;
  }
  .modal-bg.open .modal-box{transform:translateY(0);}
  /* drag handle */
  .modal-box::before{
    content:'';display:block;width:36px;height:4px;
    border-radius:2px;background:var(--b2);margin:0 auto 20px;
  }

  /* auth */
  .auth-wrap{padding:0 20px;padding-bottom:max(24px,calc(var(--sab) + 16px));}

  /* OTP stacks vertically */
  .otp-row{flex-direction:column;}
  .otp-resend{justify-content:center;width:100%;}

  /* toast wraps */
  #toast{white-space:normal;text-align:center;line-height:1.5;border-radius:16px;padding:10px 18px;}

  .empty,.no-conv{padding-bottom:40px;}
}

/* ═══════════════════════════════════════════════════════════
   EXTRA SMALL  < 380px
   ═══════════════════════════════════════════════════════════ */
@media(max-width:380px){
  :root{--sb:90vw;}
  .auth-h{font-size:20px;}
  .seg-btn{font-size:11px;padding:8px 3px;}
  .msg-bubble{max-width:94%;font-size:12.5px;}
  .model-chip{padding:4px 9px;font-size:9px;}
  .auth-wrap{padding:0 16px;}
}

/* ═══════════════════════════════════════════════════════════
   WIDE DESKTOP  ≥ 1200px
   ═══════════════════════════════════════════════════════════ */
@media(min-width:1200px){
  #messages{padding:40px 18% 28px;}
  .input-area{padding:8px 18% 18px;}
  .msg-bubble{font-size:14px;max-width:68%;}
}